{"map":{"version":3,"sources":["static/js/main.a64b6d48.chunk.js"],"names":["this","push","19","module","exports","__webpack_require__","27","__webpack_exports__","r","react","react_default","n","react_dom","react_dom_default","regenerator","regenerator_default","toConsumableArray","asyncToGenerator","classCallCheck","createClass","inherits","createSuper","dist","StreamlitAudioRecorder_StreamlitAudioRecorder","_StreamlitComponentBa","Object","StreamlitAudioRecorder","_super","props","_this","call","canvasRef","drawWaveform","state","analyser","current","canvas","canvasCtx","getContext","bufferLength","frequencyBinCount","dataArray","Uint8Array","draw","isRecording","animationId","requestAnimationFrame","setState","getByteTimeDomainData","fillStyle","fillRect","width","height","lineWidth","strokeStyle","beginPath","sliceWidth","x","i","y","moveTo","lineTo","stroke","cancelAnimationFrame","startRecording","a","mark","_callee","stream","audioContext","source","mediaRecorder","wrap","_context","prev","next","navigator","mediaDevices","getUserMedia","audio","channelCount","sampleRate","echoCancellation","noiseSuppression","autoGainControl","sent","AudioContext","createMediaStreamSource","createAnalyser","connect","MediaRecorder","mimeType","audioBitsPerSecond","ondataavailable","e","data","size","chunks","concat","onstop","blob","Blob","type","audioUrl","URL","createObjectURL","audioBlob","reader","FileReader","onloadend","base64Audio","result","split","uint8Array","atob","map","c","charCodeAt","arr","fromEntries","entries","setComponentValue","setTimeout","status","readAsDataURL","start","t0","console","error","stop","stopRecording","getTracks","forEach","track","resetRecording","audioData","downloadRecording","datetime","Date","toLocaleString","replace","filename","document","createElement","style","display","href","download","body","appendChild","click","removeChild","render","theme","borderStyling","primaryColor","border","outline","ref","id","onClick","controls","src","marginTop","createRef","key","value","src_StreamlitAudioRecorder","setComponentReady","setFrameHeight","StrictMode","getElementById"],"mappings":"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"},"code":"(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{19:function(e,t,a){e.exports=a(27)},27:function(e,t,a){\"use strict\";a.r(t);var n=a(8),i=a.n(n),o=a(17),r=a.n(o),c=a(4),l=a.n(c),s=a(5),d=a(6),u=a(0),m=a(1),h=a(2),g=a(3),f=a(9),R=function(e){Object(h.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).canvasRef=void 0,n.drawWaveform=function(){if(n.state.analyser&&n.canvasRef.current){var e=n.canvasRef.current,t=e.getContext(\"2d\"),a=n.state.analyser.frequencyBinCount,i=new Uint8Array(a);!function o(){if(n.state.isRecording){var r=requestAnimationFrame(o);if(n.setState({animationId:r}),n.state.analyser.getByteTimeDomainData(i),t){t.fillStyle=\"rgb(200, 200, 200)\",t.fillRect(0,0,e.width,e.height),t.lineWidth=2,t.strokeStyle=\"rgb(0, 0, 0)\",t.beginPath();for(var c=1*e.width/a,l=0,s=0;s<a;s++){var d=i[s]/128*e.height/2;0===s?t.moveTo(l,d):t.lineTo(l,d),l+=c}t.lineTo(e.width,e.height/2),t.stroke()}}else n.state.animationId&&cancelAnimationFrame(n.state.animationId)}()}},n.startRecording=Object(d.a)(l.a.mark((function e(){var t,a,i,o,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:44100,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});case 3:t=e.sent,a=new AudioContext,i=a.createMediaStreamSource(t),o=a.createAnalyser(),i.connect(o),(r=new MediaRecorder(t,{mimeType:\"audio/webm;codecs=opus\",audioBitsPerSecond:128e3})).ondataavailable=function(e){e.data.size>0&&n.setState((function(t){return{chunks:[].concat(Object(s.a)(t.chunks),[e.data])}}))},r.onstop=function(){var e=new Blob(n.state.chunks,{type:\"audio/webm;codecs=opus\"}),t=URL.createObjectURL(e);n.setState({chunks:[],audioBlob:e,isRecording:!1,mediaRecorder:null,audioUrl:t});var a=new FileReader;a.onloadend=function(){var e=a.result.split(\",\")[1],t=new Uint8Array(atob(e).split(\"\").map((function(e){return e.charCodeAt(0)}))),n=Object.fromEntries(Object(s.a)(t.entries()));f.a.setComponentValue({arr:n}),setTimeout((function(){f.a.setComponentValue({status:\"ready\"})}),100)},a.readAsDataURL(e)},r.start(100),n.setState({mediaRecorder:r,isRecording:!0,analyser:o},n.drawWaveform),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(\"Error accessing microphone:\",e.t0);case 18:case\"end\":return e.stop()}}),e,null,[[0,15]])}))),n.stopRecording=function(){if(n.state.mediaRecorder&&n.state.isRecording){if(n.state.mediaRecorder.stop(),n.state.mediaRecorder.stream.getTracks().forEach((function(e){return e.stop()})),n.canvasRef.current){var e=n.canvasRef.current,t=e.getContext(\"2d\");t&&(t.fillStyle=\"rgb(200, 200, 200)\",t.fillRect(0,0,e.width,e.height),t.lineWidth=2,t.strokeStyle=\"rgb(0, 0, 0)\",t.beginPath(),t.moveTo(0,e.height/2),t.lineTo(e.width,e.height/2),t.stroke())}n.state.animationId&&cancelAnimationFrame(n.state.animationId)}},n.resetRecording=function(){if(n.state.animationId&&cancelAnimationFrame(n.state.animationId),n.canvasRef.current){var e=n.canvasRef.current,t=e.getContext(\"2d\");t&&(t.fillStyle=\"rgb(200, 200, 200)\",t.fillRect(0,0,e.width,e.height),t.lineWidth=2,t.strokeStyle=\"rgb(0, 0, 0)\",t.beginPath(),t.moveTo(0,e.height/2),t.lineTo(e.width,e.height/2),t.stroke())}n.setState({isRecording:!1,audioBlob:null,chunks:[],audioUrl:null,audioData:null,analyser:null,animationId:null}),f.a.setComponentValue(null)},n.downloadRecording=function(){if(n.state.audioBlob){var e=(new Date).toLocaleString().replace(/[\\s,]/g,\"\").replace(/_/g,\"\"),t=\"streamlit_audio_\".concat(e,\".webm\"),a=document.createElement(\"a\");a.style.display=\"none\",a.href=URL.createObjectURL(n.state.audioBlob),a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}},n.render=function(){var e=n.props.theme,t={};if(e){var a=\"1px solid \".concat(n.state.isRecording?e.primaryColor:\"gray\");t.border=a,t.outline=a}return i.a.createElement(\"div\",null,i.a.createElement(\"canvas\",{ref:n.canvasRef,width:\"500\",height:\"100\",style:{border:\"1px solid #000\"}}),i.a.createElement(\"div\",null,i.a.createElement(\"button\",{id:\"record\",onClick:n.state.isRecording?n.stopRecording:n.startRecording,style:t},n.state.isRecording?\"Stop Recording\":\"Start Recording\"),i.a.createElement(\"button\",{id:\"reset\",onClick:n.resetRecording,style:t},\"Reset\"),i.a.createElement(\"button\",{id:\"download\",onClick:n.downloadRecording,style:t},\"Download\"),n.state.audioUrl&&i.a.createElement(\"audio\",{id:\"audio\",controls:!0,src:n.state.audioUrl,style:{marginTop:\"10px\",width:\"100%\"}})))},n.state={isRecording:!1,mediaRecorder:null,audioBlob:null,chunks:[],audioUrl:null,audioData:null,analyser:null,animationId:null},n.canvasRef=i.a.createRef(),n}return Object(m.a)(a,[{key:\"componentDidMount\",value:function(){if(this.canvasRef.current){var e=this.canvasRef.current,t=e.getContext(\"2d\");t&&(t.fillStyle=\"rgb(200, 200, 200)\",t.fillRect(0,0,e.width,e.height),t.lineWidth=2,t.strokeStyle=\"rgb(0, 0, 0)\",t.beginPath(),t.moveTo(0,e.height/2),t.lineTo(e.width,e.height/2),t.stroke())}}},{key:\"componentWillUnmount\",value:function(){this.state.animationId&&cancelAnimationFrame(this.state.animationId)}}]),a}(f.b),p=Object(f.c)(R);f.a.setComponentReady(),f.a.setFrameHeight(),r.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(p,null)),document.getElementById(\"root\"))}},[[19,1,2]]]);","extractedComments":[]}