(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{21:function(e,t,a){e.exports=a(29)},29:function(e,t,a){"use strict";a.r(t);var n=a(9),o=a.n(n),i=a(19),r=a.n(i),c=a(8),d=a(4),s=a.n(d),l=a(5),u=a(6),m=a(0),p=a(1),f=a(2),b=a(3),h=a(13),g=function(e){Object(f.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).canvasRef=void 0,n.drawWaveform=function(){if(n.state.analyser&&n.canvasRef.current){var e=n.canvasRef.current,t=e.getContext("2d"),a=n.state.analyser.frequencyBinCount,o=new Uint8Array(a);!function i(){if(n.state.isRecording){var r=requestAnimationFrame(i);if(n.setState({animationId:r}),n.state.analyser.getByteTimeDomainData(o),t){t.fillStyle="#f0f0f0",t.fillRect(0,0,e.width,e.height);var c=t.createLinearGradient(0,0,e.width,0);c.addColorStop(0,"#ff4b4b"),c.addColorStop(1,"#ff8b8b"),t.lineWidth=3,t.strokeStyle=c,t.beginPath();for(var d=1*e.width/a,s=0,l=e.height/2,u=0;u<a;u++){var m=o[u]/128*e.height/2;if(0===u)t.moveTo(s,m);else{var p=(s+(s-d))/2;t.quadraticCurveTo(s-d,l,p,m)}l=m,s+=d}t.lineTo(e.width,e.height/2),t.stroke()}}else n.state.animationId&&cancelAnimationFrame(n.state.animationId)}()}},n.startRecording=Object(u.a)(s.a.mark((function e(){var t,a,o,i,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:44100,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});case 3:t=e.sent,a=new AudioContext,o=a.createMediaStreamSource(t),i=a.createAnalyser(),o.connect(i),(r=new MediaRecorder(t,{mimeType:"audio/webm;codecs=opus",audioBitsPerSecond:128e3})).ondataavailable=function(e){e.data.size>0&&n.setState((function(t){return{chunks:[].concat(Object(l.a)(t.chunks),[e.data])}}))},r.onstop=function(){var e=new Blob(n.state.chunks,{type:"audio/webm;codecs=opus"});n.setState({chunks:[],audioBlob:e,isRecording:!1,mediaRecorder:null,audioUrl:URL.createObjectURL(e)}),e.arrayBuffer().then((function(e){var t=new Uint8Array(e);h.a.setComponentValue({arr:Object.fromEntries(t.entries())})}))},r.start(100),n.setState({mediaRecorder:r,isRecording:!0,analyser:i},n.drawWaveform),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Error accessing microphone:",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])}))),n.stopRecording=function(){n.state.mediaRecorder&&n.state.isRecording&&(n.state.mediaRecorder.stop(),n.state.mediaRecorder.stream.getTracks().forEach((function(e){return e.stop()})),n.state.animationId&&cancelAnimationFrame(n.state.animationId))},n.resetRecording=function(){n.state.animationId&&cancelAnimationFrame(n.state.animationId),n.setState({isRecording:!1,audioBlob:null,chunks:[],audioUrl:null,audioData:null,analyser:null,animationId:null}),h.a.setComponentValue(null)},n.downloadRecording=function(){if(n.state.audioBlob){var e=(new Date).toLocaleString().replace(/[\s,]/g,"").replace(/_/g,""),t="streamlit_audio_".concat(e,".webm"),a=document.createElement("a");a.style.display="none",a.href=URL.createObjectURL(n.state.audioBlob),a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)}},n.render=function(){var e={};if(n.props.theme){var t="1px solid ".concat(n.state.isRecording?"#ff4b4b":"#e0e0e0");e.border=t,e.outline=t}return o.a.createElement("div",{style:{padding:"20px",background:"white",borderRadius:"10px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)"}},o.a.createElement("canvas",{ref:n.canvasRef,width:"500",height:"100",style:{border:"none",borderRadius:"8px",background:"#f0f0f0",marginBottom:"20px"}}),o.a.createElement("div",{style:{display:"flex",gap:"10px",alignItems:"center"}},o.a.createElement("button",{id:"record",onClick:n.state.isRecording?n.stopRecording:n.startRecording,style:Object(c.a)(Object(c.a)({},e),{},{padding:"8px 16px",borderRadius:"6px",background:n.state.isRecording?"#ff4b4b":"white",color:n.state.isRecording?"white":"#333",cursor:"pointer",transition:"all 0.2s ease"})},n.state.isRecording?"Stop Recording":"Start Recording"),o.a.createElement("button",{id:"reset",onClick:n.resetRecording,style:Object(c.a)(Object(c.a)({},e),{},{padding:"8px 16px",borderRadius:"6px",background:"white",cursor:"pointer",transition:"all 0.2s ease"})},"Reset"),o.a.createElement("button",{id:"download",onClick:n.downloadRecording,style:Object(c.a)(Object(c.a)({},e),{},{padding:"8px 16px",borderRadius:"6px",background:"white",cursor:"pointer",transition:"all 0.2s ease"})},"Download"),n.state.audioUrl&&o.a.createElement("audio",{id:"audio",controls:!0,src:n.state.audioUrl,style:{marginLeft:"auto",width:"250px",height:"40px",borderRadius:"20px"}})))},n.state={isRecording:!1,mediaRecorder:null,audioBlob:null,chunks:[],audioUrl:null,audioData:null,analyser:null,animationId:null},n.canvasRef=o.a.createRef(),n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){if(this.canvasRef.current){var e=this.canvasRef.current,t=e.getContext("2d");if(t){t.fillStyle="#f0f0f0",t.fillRect(0,0,e.width,e.height);var a=t.createLinearGradient(0,0,e.width,0);a.addColorStop(0,"#ff4b4b"),a.addColorStop(1,"#ff8b8b"),t.strokeStyle=a,t.lineWidth=3,t.beginPath(),t.moveTo(0,e.height/2),t.lineTo(e.width,e.height/2),t.stroke()}}}},{key:"componentWillUnmount",value:function(){this.state.animationId&&cancelAnimationFrame(this.state.animationId)}}]),a}(h.b),R=Object(h.c)(g);h.a.setComponentReady(),h.a.setFrameHeight(),r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(R,null)),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.1c6a7e0e.chunk.js.map